# watermark

main.mを実行すれば結果が出力される

＜流れ＞

①移動体検出
　MotionBasedMultiObjectTrackingExampleで移動体のあるフレーム番号をnumframeに格納

②動画ファイル→画像ファイル（1フレームずつに分割）
　
③電子透かし埋め込み
　wtmark2.m で電子透かし埋め込みを行っている
 
　8×8のMBが64×64のフレームを形成
 
　移動体のあるなしをyの値で判別
 
→それぞれの透かし埋め込みへ

④psnrやssim計算

⑤改ざん

　tampering.mによって空間的改ざん箇所を決定
 
　main.m には時間的改ざんをコメント文で記載

⑥電子透かし抽出
　<移動体があった場合>
　　exwmark.mはMB一つずつの電子透かしを抽出
　　→抽出した電子透かしの値と今の画像から計算した値が異なっていた場合に改ざん位置とみなす
    B3にそのまま改ざん検出を行った画素値行列を格納
  <移動体がない場合>
　　1枚目のフレームに対してはexwmark3.mによって横の拡大MBから透かし抽出を行い，
　　flag1に改ざん部分のフラグを格納
　　2枚目のフレームに対してはexwmark4.mによって縦の拡大MBから抽出
　　flag2に改ざん部分のフラグを格納
　　
　　関数sinflag.mによってflag1とflag2の共通改ざん部分を返す

　　改ざん数を改ざん検出数が超えたときとそうでないときを場合分け

　　res.mによって1枚目のフレームB1と2枚目のフレームB3に対して改ざん検出が行われた箇所をマーク

⑦各パラメータ結果をそれぞれ出力
